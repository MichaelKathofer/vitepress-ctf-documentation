<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Building a Timer Plugin | CTF Report Documentation </title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/assets/style.cac40d77.css">
    <link rel="modulepreload" href="/assets/Home.08ad8df7.js">
    <link rel="modulepreload" href="/assets/app.31e8653d.js">
    <link rel="modulepreload" href="/assets/timerPlugin.md.5071e9e8.lean.js">
    <link rel="modulepreload" href="/assets/app.31e8653d.js">
    <meta name="twitter:title" content="Building a Timer Plugin | CTF Report Documentation ">
    <meta property="og:title" content="Building a Timer Plugin | CTF Report Documentation ">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-675d8756><div class="sidebar-button" data-v-675d8756><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="CTF Report Documentation , back to home" data-v-675d8756 data-v-4a583abe><!----> CTF Report Documentation </a><div class="flex-grow" data-v-675d8756></div><div class="nav" data-v-675d8756><nav class="nav-links" data-v-675d8756 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/aboutMe" data-v-b8818f8c>About <!----></a></div></div><!--]--><!----><!----></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-83e92a68><nav class="nav-links nav" data-v-83e92a68 data-v-eab3edfe><!--[--><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/" data-v-b8818f8c>Home <!----></a></div></div><div class="item" data-v-eab3edfe><div class="nav-link" data-v-eab3edfe data-v-b8818f8c><a class="item" href="/aboutMe" data-v-b8818f8c>About <!----></a></div></div><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar-links" data-v-83e92a68><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/">Introduction</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/research">Research</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/proofOfConcept">Proof of Concept</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/ctfdframework">CTFd Framework</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/plugins">Plugins overview</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item active" href="/timerPlugin">Timer Plugin</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#concept">Concept</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#styling">Styling</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#the-idea-in-code">The idea in code</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#animation">Animation</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#plugin">Plugin</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#create-challenge-adaptation">create challenge adaptation</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#before">Before</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#after">After</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="#error-handling">error handling</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/theme">Theme</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/roadmap">Roadmap</a><!----></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-7eddb2c4><div class="container" data-v-7eddb2c4><!--[--><!--]--><div style="position:relative;" class="content" data-v-7eddb2c4><div><h1 id="building-a-timer-plugin" tabindex="-1">Building a Timer Plugin <a class="header-anchor" href="#building-a-timer-plugin" aria-hidden="true">#</a></h1><p>The final plugin should show progress bar that indicates how much time is till left at the current question.</p><h2 id="concept" tabindex="-1">Concept <a class="header-anchor" href="#concept" aria-hidden="true">#</a></h2><h3 id="styling" tabindex="-1">Styling <a class="header-anchor" href="#styling" aria-hidden="true">#</a></h3><p>The styling of the component should look like the following screenshots:</p><p><img src="/TimerFunction.png" alt="An image"></p><h3 id="the-idea-in-code" tabindex="-1">The idea in code <a class="header-anchor" href="#the-idea-in-code" aria-hidden="true">#</a></h3><p>At first the HTML:</p><div class="language-html"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>border m-5 p-2 rounded-lg bg-white<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Time left <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>progress</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>progress-indicator w-100<span class="token punctuation">&quot;</span></span><span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>progressBar<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>progress</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>This basic countdown function counts down from 10 and sets the progress html element according to the value of the value of the timerFunction var</p><div class="language-js"><pre><code><span class="token keyword">var</span> timeToCountDown <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timerFunction <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timeToCountDown <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>downloadTimer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.challenge-submit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;progressBar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">-</span> timeleft<span class="token punctuation">;</span>
    timeToCountDown <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The problem with this solution is that the progress-bar is jumpy with no animations.</p><h3 id="animation" tabindex="-1">Animation <a class="header-anchor" href="#animation" aria-hidden="true">#</a></h3><p>The change of the different states in the progressbar (0% -&gt; 10% -&gt; 20%-&gt; ... -&gt; 100%)</p><p>After a lot of experimentation with different @keyframe progress animations the solution was to give the progressbar more states (from 10 to 1000). This required also the change of how long the function gets to wait before getting reexecuted.</p><div class="language-js"><pre><code><span class="token keyword">var</span> timeInput <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timeleft <span class="token operator">=</span> timeInput <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
	
	<span class="token keyword">var</span> downloadTimer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>timeleft <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token function">clearInterval</span><span class="token punctuation">(</span>downloadTimer<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;.challenge-submit&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;progressBar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">-</span> timeleft<span class="token punctuation">;</span>
		timeleft <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="plugin" tabindex="-1">Plugin <a class="header-anchor" href="#plugin" aria-hidden="true">#</a></h2><p>CTFd plugins are implemented as Python modules and include some CTFd specific files. The structure looks like the following visualisation:</p><div class="language-"><pre><code>CTFd
└── plugins
   └── CTFd-plugin
       ├── README.md          # README file
       ├── __init__.py        # Main code file loaded by CTFd
       ├── requirements.txt   # Any requirements that need to be installed
       └── config.json        # Plugin configuration file
</code></pre></div><p>CTFd is looking into the Plugin folder, after the internal routs are established. If it finds a load() function, it will executed it.</p><ul><li>config.json: Includes attributes like the name of the plugin or the route. in our case the name is TimerProgressbar.</li></ul><h2 id="create-challenge-adaptation" tabindex="-1">create challenge adaptation <a class="header-anchor" href="#create-challenge-adaptation" aria-hidden="true">#</a></h2><p>At this part there must be an input field when creating the challenge, where the Administrator can enter in the amount of time.</p><h3 id="before" tabindex="-1">Before <a class="header-anchor" href="#before" aria-hidden="true">#</a></h3><p><img src="/createChallengeScreen1.png" alt="An image"></p><h3 id="after" tabindex="-1">After <a class="header-anchor" href="#after" aria-hidden="true">#</a></h3><p>At the bottom there is the newly added input field: <img src="/createChallengeScreen2.png" alt="An image"></p><h2 id="error-handling" tabindex="-1">error handling <a class="header-anchor" href="#error-handling" aria-hidden="true">#</a></h2><p>After the implementation and the connection to the Database, errors started to occur. <img src="/fehler1.png" alt="An image"></p></div></div><footer class="page-footer" data-v-7eddb2c4 data-v-fb8d84c6><div class="edit" data-v-fb8d84c6><div class="edit-link" data-v-fb8d84c6 data-v-1ed99556><!----></div></div><div class="updated" data-v-fb8d84c6><!----></div></footer><div class="next-and-prev-link" data-v-7eddb2c4 data-v-38ede35f><div class="container" data-v-38ede35f><div class="prev" data-v-38ede35f><a class="link" href="/plugins" data-v-38ede35f><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-38ede35f><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-38ede35f>Plugins overview</span></a></div><div class="next" data-v-38ede35f><a class="link" href="/theme" data-v-38ede35f><span class="text" data-v-38ede35f>Theme</span><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-next" data-v-38ede35f><path d="M19.9,12.4c0.1-0.2,0.1-0.5,0-0.8c-0.1-0.1-0.1-0.2-0.2-0.3l-7-7c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4l5.3,5.3H5c-0.6,0-1,0.4-1,1s0.4,1,1,1h11.6l-5.3,5.3c-0.4,0.4-0.4,1,0,1.4c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3l7-7C19.8,12.6,19.9,12.5,19.9,12.4z"></path></svg></a></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"aboutme.md\":\"60d7c06b\",\"ctfdframework.md\":\"40b35a0b\",\"index.md\":\"51e43307\",\"plugins.md\":\"6224d255\",\"proofofconcept.md\":\"2492b5a6\",\"research.md\":\"37db2833\",\"roadmap.md\":\"5c7f32b4\",\"theme.md\":\"719f80d0\",\"timerplugin.md\":\"5071e9e8\"}")</script>
    <script type="module" async src="/assets/app.31e8653d.js"></script>
    
  </body>
</html>